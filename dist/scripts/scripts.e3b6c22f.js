"use strict";angular.module("parkingApiApp",["ngAnimate","ngAria","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch","ngMap","ngMaterial"]).constant("config",function(){var a="";return{apiBaseUrl:a,apiUrl:a+"/api/v1"}}()).config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).otherwise({redirectTo:"/"}),b.html5Mode(!0)}]),angular.module("parkingApiApp").controller("MainCtrl",["$scope","parkingService","staticService",function(a,b,c){var d;a.$on("mapInitialized",function(a,b){d=b}),a.features=[],b.getParkings(25).then(function(d){d&&d.data&&"ok"===d.data.status&&(a.features=d.data.features,a.features.forEach(function(a){a.theCoordinates=[a.geometry.coordinates[1],a.geometry.coordinates[0]];var d=a.properties.layers[c.getParkingGarageField().parkingGarage].data;a.theIcon=b.getGarageAvailabilityIcon(d),a.garageAvailability=b.garageAvailability(d),a.name=d[c.getParkingGarageField().name]}),a.center=c.getNLCoordinates().lat+","+c.getNLCoordinates()["long"])}),a.showGarage=function(e,f){a.selectedGarage=f;var g=a.selectedGarage.properties.layers[c.getParkingGarageField().parkingGarage].data,h=new google.maps.InfoWindow({pixelOffset:new google.maps.Size(c.getStatic().pixelOffsetX,c.getStatic().pixelOffsetY)}),i=new google.maps.LatLng(f.theCoordinates[0],f.theCoordinates[1]);h.setContent(b.getInfoWindowTemplate(g)),h.setPosition(i),h.open(d)}}]),angular.module("parkingApiApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("parkingApiApp").service("parkingService",["$http","config","staticService",function(a,b,c){this.getParkings=function(c){var d=b.apiUrl+"/parking?limit="+c;return a.get(d)},this.getInfoWindowTemplate=function(a){var b=this.garageAvailability(a);return"<h3>"+a[c.getParkingGarageField().name]+"</h3><p>Free Space Short  : "+b.freeSpaceShort+"</p><p>Free Space Long   : "+b.freeSpaceLong+"</p>"},this.garageAvailability=function(a){return{freeSpaceShort:(a[c.getParkingGarageField().freeSpaceShort]||"-")+" / "+(a[c.getParkingGarageField().shortCapacity]||"-"),freeSpaceLong:(a[c.getParkingGarageField().freeSpaceLong]||"-")+" / "+(a[c.getParkingGarageField().longCapacity]||"-")}},this.isGarageAvailable=function(a){var b=!0,d=a[c.getParkingGarageField().freeSpaceShort];d&&0===d&&(b=!1);var e=a[c.getParkingGarageField().freeSpaceLong];return e&&0===e&&(b=!1),b},this.getGarageAvailabilityIcon=function(a){var b="",d=!1,e=a[c.getParkingGarageField().freeSpaceShort],f=a[c.getParkingGarageField().shortCapacity];e&&e>0&&f&&f>0?d=!0:e||f||(g=!0);var g=!1,h=a[c.getParkingGarageField().freeSpaceLong],i=a[c.getParkingGarageField().longCapacity];return h&&h>0&&i&&i>0?g=!0:h||i||(g=!0),b=d&&g?c.getMarkerIcon().available:d||g?c.getMarkerIcon().partiallyAvaialble:c.getMarkerIcon().notAvailable}}]),angular.module("parkingApiApp").service("staticService",function(){this.getMarkerIcon=function(){return{notAvailable:"",available:"/images/available.8152b5bf.png",partiallyAvaialble:"/images/partially-available.5db9be82.png"}},this.getNLCoordinates=function(){return{lat:"52.36763394","long":"4.90058899"}},this.getStatic=function(){return{pixelOffsetX:0,pixelOffsetY:-37}},this.getParkingGarageField=function(){return{parkingGarage:"parking.garage",freeSpaceShort:"FreeSpaceShort",shortCapacity:"ShortCapacity",freeSpaceLong:"FreeSpaceLong",longCapacity:"LongCapacity",name:"Name"}}}),angular.module("parkingApiApp").run(["$templateCache",function(a){a.put("views/about.html","<p>This is the about view.</p>"),a.put("views/main.html",'<div class="container mb-20"> <map zoom-to-include-markers="true" zoom="12" center="{{ center }}" style="display:block; width:auto; height:auto"> <marker ng-repeat="feature in features" position="{{feature.theCoordinates}}" title="{{ feature.properties.title }}" on-click="showGarage(event, feature)" icon="{{ feature.theIcon }}"></marker> </map> </div> <div class="container mb-20" ng-show="selectedGarage"> <md-card> <md-card-title> <md-card-title-text> <span class="md-headline">{{ selectedGarage.name}}</span> <span class="md-subhead">Free Space Short : {{ selectedGarage.garageAvailability.freeSpaceShort }}</span> <span class="md-subhead">Free Space Long : {{ selectedGarage.garageAvailability.freeSpaceLong }}</span> </md-card-title-text> </md-card-title> </md-card> </div>')}]);